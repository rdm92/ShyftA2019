{"triggers":[],"nodes":[{"uid":"c5631c3e-ffaf-43e4-afd9-03d9010c8522","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f83dd084-5dbf-4ae1-9c41-a30b4d3b512c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"Rename Splitted Invoices Task  -  Started"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5f02d7ae-bebd-46e0-b689-2000f92ccc30","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"daae2b2e-fa78-4961-a452-a05daeccc09c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"File Name: $vInvoiceFile{name}$.$vInvoiceFile{extension}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"22e663ed-6234-4e61-a4e8-eb2aff84068c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"0825a51a-c401-430a-b76f-f8da96539993","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vInvoiceFile{name}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":"_"}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vSupplierName"}},{"uid":"863f6ccc-bffd-4ac1-9e75-f562f87533d8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"64891c8f-c4a5-4d60-8f9f-38ac93f81eb2","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"BASIC_ISO_DATE"}}],"returnTo":{"type":"VARIABLE","variableName":"vDate"}},{"uid":"5c9df964-f1d5-4111-834b-520d3358922d","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDate$"}},{"name":"find","value":{"type":"STRING","string":"Z"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vDate"}},{"uid":"37886d32-79aa-4073-9021-9809313110d7","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_TIME"}}],"returnTo":{"type":"VARIABLE","variableName":"vTime"}},{"uid":"0b9640b0-71c5-4372-a4c0-6830055a62f5","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTime$"}},{"name":"find","value":{"type":"STRING","string":":"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vTime"}},{"uid":"c5b12919-7b39-4079-b4bb-51794ac93192","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTime$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"subStringLength","value":{"type":"NUMBER","number":"6"}}],"returnTo":{"type":"VARIABLE","variableName":"vTime"}},{"uid":"d3310582-98de-4a61-a789-72e19613b387","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSupplierName$_$vDate$_$vTime$.pdf"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileNewName"}},{"uid":"a34d2af6-2215-461c-958d-bd3f9e727242","commandName":"renameFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderInputInvoice$/$vInvoiceFile{name}$.pdf"}},{"name":"newFileName","value":{"type":"STRING","expression":"$vFolderInputInvoice$\\$vFileNewName$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a984d1d5-a840-4422-9995-78d56ab40ce2","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"1"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"5bd47546-fce1-4760-bb88-a256bc3b0a37","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"File New Name: $vFileNewName$.pdf"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"4ed538dd-6015-4d5f-9ab2-030504381f3b","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"f0e2a70e-ed06-49b2-9fe4-0c1c21935223","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Could not change file name: $vInvoiceFile{name}$.$vInvoiceFile{extension}$ as there is underscore (_) in file name."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ce6db287-9826-4184-90b0-e568966ee9cd","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vSupplierName$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"9632c510-28ec-452c-ab76-24e564f7d24c","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"47720195-d0b2-4ad8-a630-57cf09302632","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Not a PDF File: $vInvoiceFile{name}$.$vInvoiceFile{extension}$. So, no change in file name."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"cedba166-5019-4466-9f61-a4cb0fa8d83e","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"1"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"86acf14b-87a8-4892-b2a6-9b7196aa9d23","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vInvoiceFile{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"pdf"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"a9f2dba7-c2cd-4a29-ae82-6eb28c482a3c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"Rename Splitted Invoices Task  -  Ended"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vInvoiceFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vFolderInputInvoice$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"branches":[{"uid":"24bddb09-01eb-41ba-bb12-ef7b45d8b25f","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"dbea2d54-e874-4a4a-b346-0664d9f67eb9","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLineString"}},{"uid":"a80c8f57-5da4-42f5-908d-2bfb82280e34","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vSubTaskErrorFlag"}},{"uid":"a2bae0e9-6fed-410d-9997-f6bec962b2e8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderErrorLog$/$vFileNameErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Bot Error Message: $vErrorDescription$ at line $vErrorLineString$ in $System:AATaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vFolderInputInvoice","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvoiceFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vSupplierName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vFileNewName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vFolderAuditLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileNameAuditLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolderErrorLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileNameErrorLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vErrorLineString","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vSubTaskErrorFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"BOOLEAN","boolean":false}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.0.0-20200721-221936"},{"name":"Datetime","version":"2.0.0-20200721-221958"},{"name":"Delay","version":"2.1.0-20200721-221959"},{"name":"ErrorHandler","version":"2.0.0-20200721-222009"},{"name":"File","version":"2.1.0-20200721-222011"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"LogToFile","version":"2.1.0-20200721-222212"},{"name":"Loop","version":"2.0.0-20200721-222213"},{"name":"Number","version":"2.0.0-20200721-222224"},{"name":"String","version":"3.0.0-20200721-222454"},{"name":"System","version":"2.0.0-20200721-222454"}],"workItemTemplateName":null}