{"triggers":[],"nodes":[{"uid":"52780497-16e3-4714-a94c-c6ac1c6413ff","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"158c3eb4-467e-4764-b200-5cf528a5e7f7","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"IQ Bot Data Extraction Task  -  Started"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f1697e1b-62f5-4815-88b5-3f720929f2a4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Validation_$vTimeStamp$"}}],"returnTo":{"type":"VARIABLE","variableName":"vValidationFileName"}},{"uid":"a3728b79-3c13-44ee-a4c9-59e46a160305","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"CSV File created to track files gone for validation: $vValidationFileName$."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"d274e9ce-e85c-4e52-9dcb-5c2dadf9f7d8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderIQBotOutput$/$vValidationFileName$.csv"}},{"name":"logContent","value":{"type":"STRING","string":"Invoice_Date,Invoice_Number,Invoice_Total,Purchase_Order_Number,Freight,Supplier_Code,Packing_Slip_number,Tariff,Supplier_Name,Billing_Address,Bill_to_name,Item_Total,Quantity,Item_Number,Unit_of_Measure,Unit_Price,Packing_Slip_No,PO_Number,Tarrif_at_table,Result,File Path,File_Name,Batch_Code,Error,Status,Comment,Invoice_File_Path"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"70b50f5a-3045-41a6-9a16-d7aac775f2c3","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vValidationDataFlag"}},{"uid":"4e66ae73-c663-4f83-b94d-793ebfa5f751","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"IQ Bot File Uploading  -  Started"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4d23d99f-8cd0-4609-ba87-9a82c075aa5b","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"215ddfbd-de09-407e-8cd7-e8167ed136c8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Uploading File: $vInvoicesFileName{name}$.pdf"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"42ae5cee-cea3-4116-8df4-0068bbd28d69","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"aa86134d-e5c2-400d-b27f-8503f3cd5a2f","commandName":"IQBotUpload","packageName":"IQ Bot","disabled":false,"attributes":[{"name":"learningInstanceId","value":{"type":"STRING","string":"50102736-1ea3-442f-aece-e16ab136aacd","label":"Shyft Invoices"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderInputInvoices$/$vInvoicesFileName{name}$.pdf"}}],"returnTo":{"type":"VARIABLE","variableName":"vIQBotResponse"}},{"uid":"39788dac-3dfc-4263-857f-3159f6461c70","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Wait for file to be processed."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"3aa30e49-4876-4a50-99ab-4af026cb77d8","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Wait for file to be processed."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"2e0b31c3-10b8-4bcf-9016-19f12266aca8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Upload Status: $vIQBotResponse$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"40322d7c-5454-4764-ab3a-f5d4010d84e1","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"41132b28-db39-4d19-99f8-e36ab31cda6a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Upload Status: $vIQBotResponse$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4965e301-d854-4394-8df9-1e4f976b689c","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vInvoicesFileName"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vFolderInputInvoices$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"264b374a-ed46-4079-8bb3-a30cd76d74dd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"IQ Bot File Uploading  -  Ended"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4303bd2e-1efb-4e1a-8aa1-361f6ea65681","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"beef9481-b0c0-4edc-8b47-16b27dcc5481","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Delay before downloading csv files."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"a4467db1-e28c-41c4-8216-5edaec0b1ffc","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"Delay before downloading csv files."}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":true}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","attributes":[{"name":"times","value":{"type":"NUMBER","number":"12"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]},{"uid":"67fec394-3988-449a-8b8e-e4f2c27053ae","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"IQ Bot Output CSV Files Downloading  -  Started"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"10644297-17db-4a9f-812d-ff9c55407ca6","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"895e3e7b-da27-4488-a644-e30f26fe8b53","commandName":"IQBotDownload","packageName":"IQ Bot","disabled":false,"attributes":[{"name":"learningInstance","value":{"type":"STRING","string":"50102736-1ea3-442f-aece-e16ab136aacd","label":"Shyft Invoices"}},{"name":"docType","value":{"type":"STRING","string":"SUCCESS"}},{"name":"outDir","value":{"type":"STRING","expression":"$vFolderIQBotOutput$"}},{"name":"deleteAfterDownload","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vOutputDownloadResponse"}}],"branches":[{"uid":"66a42fd9-b641-4a15-82f8-60e9b784a2ac","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4e96d87e-c168-4f20-9cc3-dde6244006aa","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"All the files are on IQ Bot Validation. Bot Message: $vErrorDescription$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"}}}]},{"uid":"abb3bdfb-1e90-4e6a-b11c-b1077eb471f4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"IQ Bot Output CSV Files Downloading  -  Ended"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9095ba7c-4095-4a14-90fb-c0727f81088e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"Check for Files in validation  -  Started"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"7937037f-538b-4321-b4fb-346b2a0d6966","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"fd93bb09-e145-4005-81ae-257d835169a9","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vValidationFileFlag"}},{"uid":"923aa958-f335-478f-ab10-6f2b55b804f8","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"585f93c7-ef27-423c-9613-89dc68833b8f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c4355c85-f4d0-4766-91c2-ff5566277f8a","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vValidationFileFlag"}},{"uid":"c758655d-cc8a-4536-bc37-861a73f2060b","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vOutputCSVFiles{name}$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$vInputInvoices{name}$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vOutputCSVFiles"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vFolderIQBotOutput$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"36aae05c-57e8-4569-aacc-dbbaf7d38cb3","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"90c24bfa-b91d-4e79-93b9-5429041675c6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"File \"$vInputInvoices{name}$.pdf\" stuck in IQ Bot validation."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"e6e0fc95-0cd7-4f10-8a86-2a078c6bc031","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vFolderInputInvoices$/$vInputInvoices{name}$.pdf"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$vFolderValidation$\\$vInputInvoices{name}$.pdf"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"19d995ac-d87d-4b06-a8e6-6dc73b2f0e31","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"File move to Validation Folder: \"$vFolderValidation$\\$vInputInvoices{name}$.pdf\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"9726b9d4-75d5-4209-ba98-a479979fadc6","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_DATE_TIME"}}],"returnTo":{"type":"VARIABLE","variableName":"vDateTime"}},{"uid":"227e3fbb-9da2-41ed-b111-78f3e59fcb54","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDateTime$"}},{"name":"find","value":{"type":"STRING","string":"T"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":" "}}],"returnTo":{"type":"VARIABLE","variableName":"vDateTime"}},{"uid":"7a2d10e7-3c73-4d9c-ad73-97a6f713a148","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderIQBotOutput$/$vValidationFileName$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,FALSE,NA,$vInputInvoices{name}$,NA,Yes,Validation,File require validation OR unclassified.,$vFolderValidation$\\$vInputInvoices{name}$.pdf"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"872ab0d2-8ab4-4af5-a911-c885422e864e","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vValidationDataFlag"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$vValidationFileFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vInputInvoices"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vFolderInputInvoices$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"885c790d-5670-482d-8b3b-0e726bddb6db","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"8f2a5fd0-4969-4ef5-b113-98fbeb228559","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"56e23929-96d6-447b-8982-7c4aa428fd9b","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vOutputFileName{name}$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Validation"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"929753fa-7151-4caa-b0e6-1a18a7d5aa59","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vValidationFileDownloaded"}},{"uid":"3c8dc250-5568-43d5-bce5-603240bafeb2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"CSV File \"$vOutputFileName{name}$.csv\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"02f7f92b-6b30-4acb-97ee-766f73467ea6","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vOutputFileName{name}$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":"-"}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"5"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vActualFileName"}},{"uid":"db6162bb-f068-44d0-a833-dcef7e23e05f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"0cb12828-4b82-46ea-a4e1-d2cc3c9430cc","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"500"}},{"name":"timeUnit","value":{"type":"STRING","string":"MILLISECONDS"}}]},{"uid":"77a41905-2f8b-4f43-9b6f-faf211daf264","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"93b79ca9-7cc7-48ac-931f-5fa1d4913f75","commandName":"renameFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderIQBotOutput$/$vOutputFileName{name}$.csv"}},{"name":"newFileName","value":{"type":"STRING","expression":"$vFolderIQBotOutput$\\$vActualFileName$.csv"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vActualFileName$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e2e863fd-f1b4-4c6b-b70d-7b033c16caf3","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"2"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]}],"branches":[{"uid":"e3b79150-89a3-4b5b-85a9-897a417a158d","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5cca6b6e-574f-4245-b41a-5a9d41ff4ed3","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLineString"}},{"uid":"fd932b38-64b9-42f1-ada3-53a64be7cac6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderErrorLog$/$vFileNameErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Bot Error Message: $vErrorDescription$ at line $vErrorLineString$ in $System:AATaskName$."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]},{"uid":"29dda09a-7167-48e1-8202-14b9c164c804","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Renamed as \"$vActualFileName$.csv\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vOutputFileName"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vFolderIQBotOutput$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"c5af6b68-fde9-4bf1-b193-fc1ee0b6a014","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"72426012-c0c4-4826-99dc-a44a73623f1c","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderIQBotOutput$/$vValidationFileName$.csv"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"793eeaec-e4f7-49f3-a63e-cf499e8ff1f4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"CSV File \"$vValidationFileName$.csv\" deleted as there are no files gone for IQBot Validation."}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$vValidationDataFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]},{"uid":"a9a32430-14ea-4eb8-8cfb-f594fd4ff438","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderAuditLog$/$vFileNameAuditLog$"}},{"name":"logContent","value":{"type":"STRING","string":"IQ Bot Data Extraction Task  -  Ended"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"2b5ebe7d-7555-444a-a2b8-db3e7dc47721","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"470014c2-3037-4a80-91cf-c9d8cf1cbf2e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLineString"}},{"uid":"0ed994d1-82e2-4709-b724-244a634dda76","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vSubTaskErrorFlag"}},{"uid":"498a9f77-37aa-4c38-94d3-04dc226d7ef0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderErrorLog$/$vFileNameErrorLog$"}},{"name":"logContent","value":{"type":"STRING","expression":"Bot Error Message: $vErrorDescription$ at line $vErrorLineString$ in $System:AATaskName$. Please refer error screenshot \"ErrorScreen_$vScreenshotTime$.png\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f00fca00-937b-49a5-9c4a-428e57d087b0","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_TIME"}}],"returnTo":{"type":"VARIABLE","variableName":"vScreenshotTime"}},{"uid":"3f34d2a0-8ebc-40f9-a843-fe43513d9843","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vScreenshotTime$"}},{"name":"find","value":{"type":"STRING","string":":"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vScreenshotTime"}},{"uid":"69f4103c-df13-49ec-bbb9-0b976b2a2979","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vScreenshotTime$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"subStringLength","value":{"type":"NUMBER","number":"6"}}],"returnTo":{"type":"VARIABLE","variableName":"vScreenshotTime"}},{"uid":"6578dbbc-5e3e-407d-bc5c-173f408cde57","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vFolderErrorLog$/ErrorScreen_$vScreenshotTime$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vInvoicesFileName","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vIQBotResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vFolderIQBotOutput","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vOutputDownloadResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vOutputFileName","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vActualFileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vErrorLineString","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vSubTaskErrorFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vFolderException","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolderErrorLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolderInputInvoices","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vUserEmailAddress","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vValidationFileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vValidationFileFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vInputInvoices","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vOutputCSVFiles","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vValidationDataFlag","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"vDateTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vAdminEmailAddress","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDownloadErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vDownloadErrorLine","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vDownloadErrorLineString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vFolderAuditLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileNameAuditLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileNameErrorLog","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vScreenshotTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vFolderValidation","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vValidationFileDownloaded","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"BOOLEAN","boolean":false}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.0.0-20200721-221936"},{"name":"Datetime","version":"2.0.0-20200721-221958"},{"name":"Delay","version":"2.1.0-20200721-221959"},{"name":"ErrorHandler","version":"2.0.0-20200721-222009"},{"name":"File","version":"2.1.0-20200721-222011"},{"name":"IQ Bot","version":"2.0.0-20200724-141957"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"LogToFile","version":"2.1.0-20200721-222212"},{"name":"Loop","version":"2.0.0-20200721-222213"},{"name":"MessageBox","version":"2.0.0-20200721-222213"},{"name":"Number","version":"2.0.0-20200721-222224"},{"name":"Screen","version":"2.0.0-20200721-222442"},{"name":"String","version":"3.0.0-20200721-222454"},{"name":"System","version":"2.0.0-20200721-222454"}],"workItemTemplateName":null}